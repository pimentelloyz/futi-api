# Formatos de Campeonatos - Análise e Especificação

## 1. Copa do Brasil

### Estrutura

- **Tipo:** Mata-mata (Eliminatória)
- **Fases:** 7 fases (Primeira Fase até Final)
- **Partidas:** Ida e volta em todas as fases
- **Times:** 92 times (2024)

### Regras Específicas

- **Gol fora:** Não conta mais (abolido em 2022)
- **Desempate:**
  1. Prorrogação (2x15min)
  2. Pênaltis
- **Cartões:**
  - 3 amarelos = 1 jogo de suspensão
  - 2 amarelos em mesma partida = expulsão + 1 jogo
  - Vermelho direto = no mínimo 1 jogo (pode aumentar conforme gravidade)

### Classificação por Fase

- Primeira Fase: Times piores ranqueados entram
- Segunda Fase: Entram times de melhor ranking
- Terceira Fase: Entram times da Libertadores/Sul-Americana
- Oitavas até Final: Mata-mata tradicional

## 2. Libertadores

### Estrutura

- **Tipo:** Misto (Grupos + Mata-mata)
- **Fase de Grupos:** 8 grupos com 4 times cada (32 times)
- **Jogos:** Todos contra todos no grupo (6 jogos por time)
- **Classificação:** Top 2 de cada grupo avançam

### Fase Eliminatória

- **Oitavas:** 16 times (ida e volta)
- **Quartas:** 8 times (ida e volta)
- **Semi:** 4 times (ida e volta)
- **Final:** Jogo único em sede pré-definida

### Regras Específicas

- **Gol fora:** Não conta mais
- **Desempate Grupos:**
  1. Pontos
  2. Vitórias
  3. Saldo de gols
  4. Gols marcados
  5. Confronto direto
  6. Gols fora confronto direto
  7. Sorteio
- **Cartões:**
  - 2 amarelos acumulados = 1 jogo suspensão
  - Zera após quartas de final

## 3. Copa do Mundo

### Estrutura

- **Tipo:** Misto (Grupos + Mata-mata)
- **Fase de Grupos:** 8 grupos com 4 seleções cada (32 times)
- **Jogos:** Todos contra todos (3 jogos por seleção)
- **Classificação:** Top 2 de cada grupo

### Fase Eliminatória

- **Oitavas:** 16 seleções (jogo único)
- **Quartas:** 8 seleções (jogo único)
- **Semi:** 4 seleções (jogo único)
- **Terceiro Lugar:** Disputa
- **Final:** Jogo único

### Regras Específicas

- **Desempate Grupos:**
  1. Pontos
  2. Saldo de gols
  3. Gols marcados
  4. Confronto direto (se 2 times empatados)
  5. Fair play (cartões)
  6. Sorteio FIFA
- **Cartões:**
  - 2 amarelos acumulados = 1 jogo suspensão
  - Zera após quartas
  - Vermelho = mínimo 1 jogo

## 4. Champions League

### Estrutura (Formato novo 2024/25)

- **Tipo:** Liga única + Mata-mata
- **Fase de Liga:** 36 times, cada um joga 8 partidas contra adversários diferentes
- **Classificação:**
  - Top 8: Direto para oitavas
  - 9º ao 24º: Playoffs (ida e volta)
  - 25º ao 36º: Eliminados

### Fase Eliminatória

- **Playoffs:** 16 times (9º ao 24º colocados)
- **Oitavas:** 16 times (ida e volta)
- **Quartas:** 8 times (ida e volta)
- **Semi:** 4 times (ida e volta)
- **Final:** Jogo único

### Regras Específicas

- **Desempate Fase Liga:**
  1. Pontos
  2. Saldo de gols
  3. Gols marcados
  4. Gols fora
  5. Vitórias
  6. Vitórias fora
  7. Coeficiente UEFA
- **Cartões:**
  - 3 amarelos = 1 jogo
  - Zera após quartas

## 5. Brasileirão (Série A)

### Estrutura

- **Tipo:** Pontos corridos
- **Times:** 20 times
- **Jogos:** Todos contra todos (ida e volta) = 38 rodadas
- **Sistema:** 3 pontos por vitória, 1 por empate

### Regras Específicas

- **Desempate:**
  1. Pontos
  2. Vitórias
  3. Saldo de gols
  4. Gols marcados
  5. Confronto direto
  6. Menor número cartões vermelhos
  7. Menor número cartões amarelos
  8. Sorteio
- **Rebaixamento:** 4 últimos caem para Série B
- **Libertadores:** Top 6 (ou 7 se campeão Copa do Brasil for top 6)
- **Sul-Americana:** 7º ao 12º (ou 13º)
- **Cartões:**
  - 3 amarelos = 1 jogo suspensão
  - A cada 3 novos = mais 1 jogo

## 6. Estaduais (Paulista como Referência)

### Estrutura

- **Tipo:** Misto (Grupos + Mata-mata)
- **Fase de Grupos:** 4 grupos com 4 times cada (16 times)
- **Jogos:** Todos contra todos no grupo
- **Classificação:** Top 2 de cada grupo (8 times)

### Fase Eliminatória

- **Quartas:** 8 times (ida e volta)
- **Semi:** 4 times (ida e volta)
- **Final:** Ida e volta

### Regras Específicas

- **Desempate Grupos:**
  1. Pontos
  2. Vitórias
  3. Saldo de gols
  4. Gols marcados
  5. Confronto direto
  6. Sorteio
- **Cartões:**
  - 2 amarelos = 1 jogo
  - Zera nas semis

## 7. Rachão/Pelada (Futebol Amador)

### Estrutura

- **Tipo:** Flexível (configurável)
- **Variações Comuns:**
  - Pontos corridos simples
  - Grupos com final
  - Mata-mata direto

### Formato Padrão Sugerido

- **Times:** 6 a 12 times
- **Fase 1:** Todos contra todos (turno único ou returno)
- **Fase 2 (opcional):** Semi e Final (top 4)

### Regras Específicas

- **Desempate:**
  1. Pontos
  2. Confronto direto
  3. Saldo de gols
  4. Gols marcados
- **Cartões:**
  - 2 amarelos = 1 jogo (configurável)
  - Vermelho = 1 jogo (configurável)
- **Flexibilidade:**
  - Duração de partidas configurável
  - Número de substituições ilimitado
  - Critérios personalizáveis

---

## Estrutura de Dados Necessária

### Tabelas Principais

1. **LeagueFormat** (Formato de Campeonato)
   - id, name, slug, description
   - type: ROUND_ROBIN, KNOCKOUT, MIXED, CUSTOM
   - isTemplate: boolean

2. **LeaguePhase** (Fases do Campeonato)
   - id, leagueId, formatId
   - name, order, type (GROUP_STAGE, KNOCKOUT, LEAGUE)
   - hasGroups, hasHomeAway, hasPenalties

3. **LeaguePhaseRule** (Regras por Fase)
   - id, phaseId
   - advancingTeams, eliminatedTeams
   - hasExtraTime, hasPenalties, hasAwayGoal

4. **TiebreakCriteria** (Critérios de Desempate)
   - id, leagueId, phaseId
   - order, criterion
   - criterion: POINTS, GOAL_DIFF, GOALS_FOR, HEAD_TO_HEAD, etc.

5. **DisciplineRule** (Regras Disciplinares)
   - id, leagueId
   - yellowCardsForSuspension
   - resetYellowsAfterPhase
   - redCardMinimumGames

### Endpoints Necessários

- `POST /api/leagues/:id/format` - Configurar formato
- `GET /api/leagues/:id/format` - Obter formato
- `POST /api/leagues/:id/phases` - Criar fases
- `GET /api/leagues/:id/phases` - Listar fases
- `POST /api/leagues/:id/tiebreak-rules` - Configurar desempate
- `POST /api/leagues/:id/discipline-rules` - Configurar disciplina
- `GET /api/league-formats/templates` - Listar templates pré-configurados
- `POST /api/leagues/:id/apply-template/:templateId` - Aplicar template
